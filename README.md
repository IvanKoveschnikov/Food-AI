# Еда и ИИ

Flutter-приложение для учёта блюд по фото с ИИ-анализом состава, календарём и личным кабинетом.

## Возможности

- **Главный экран**: календарь, список блюд на выбранную дату, переход в «Подробнее», добавление блюда без фото или по фото.
- **Фото/галерея**: съёмка или выбор фото, ИИ определяет название и состав (чекбоксы), добавление своих продуктов, сохранение в БД.
- **Подробнее о блюде**: просмотр и редактирование состава.
- **Добавление без фото**: по описанию (ИИ) или из готового списка (шаблоны из профиля).
- **Профиль**: выход, «Мои блюда» (шаблоны), «Мои продукты» (свои продукты).

## Запуск

```bash
flutter pub get
flutter run
```

### С Supabase и OpenRouter (ключи через dart-define)

```bash
flutter run --dart-define=SUPABASE_URL=https://ВАШ_ПРОЕКТ.supabase.co --dart-define=SUPABASE_ANON_KEY=ВАШ_ANON_KEY --dart-define=OPENROUTER_API_KEY=sk-or-v1-...
```

Все три ключа можно передать одной строкой. Без ключей приложение запустится с заглушками (без БД и без реального ИИ).

## База данных Supabase

Схема и RLS в `supabase/migrations/`:

1. `20250208000001_initial_schema.sql` — таблицы `profiles`, `products`, `dishes`, `dish_products`, `dish_templates`, `dish_template_products`, триггеры и RLS.
2. `20250208000002_storage_bucket.sql` — bucket `dish-images` и политики доступа.

В Dashboard Supabase: выполнить миграции или скопировать SQL, создать проект и подставить URL и anon key в команду запуска.

## ИИ (OpenRouter)

При заданном `OPENROUTER_API_KEY` используется OpenRouter (модель `openai/gpt-4o-mini`) для анализа фото и текста: определение названия блюда и списка продуктов. Без ключа работает заглушка с фиксированным ответом. Сервис: `lib/services/openrouter_service.dart`.
