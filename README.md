# Food AI

Мобильное приложение на Flutter для удобного учёта питания с помощью ИИ.

## Что умеет

- **Распознавание блюд по фото**  
  Сделать фото блюда (из камеры или галереи), приложение отправляет изображение в ИИ‑модель, получает название блюда и список продуктов.

- **Анализ текста**  
  Можно описать блюдо текстом, без фото. ИИ анализирует описание и предлагает название и состав.

- **Учёт блюд по дням**  
  - Главный экран с календарём  
  - Список блюд на выбранную дату  
  - Переход в экран «Подробнее» по каждому блюду

- **Собственная база продуктов и шаблонов**  
  - Глобальные продукты (общие для всех)
  - Личные продукты пользователя
  - Шаблоны блюд для быстрого добавления часто повторяющихся приёмов пищи

- **Профиль**  
  - Выход из аккаунта  
  - Управление собственными продуктами  
  - Управление шаблонами блюд

- **Supabase Storage для фото блюд**  
  Фото хранятся в приватном bucket, доступ к ним идёт через подписанные URL.

## Технологии

- Flutter 3.38
- Dart 3.10
- go_router — маршрутизация
- flutter_riverpod — управление состоянием
- supabase_flutter — база данных, аутентификация и Storage
- image_picker — работа с камерой и галереей
- table_calendar — календарь
- http — запросы к внешнему AI API

## Структура проекта

- `lib/core` — базовая логика приложения  
  - `config` — конфигурация (в том числе Supabase)  
  - `router` — маршруты  
  - `theme` — темы (светлая/тёмная)  
  - `constants` — константы строк и т.п.  

- `lib/features` — экраны и функциональные модули  
  - `auth` — авторизация и регистрация  
  - `home` — главный экран с календарём и списком блюд  
  - `camera` — экран камеры и добавления блюд без фото  
  - `dish_detail` — экран детализации блюда  
  - `profile` — экраны продуктов, шаблонов и профиля

- `lib/services` — работа с внешними сервисами  
  - Supabase (таблицы, Storage)  
  - AI‑сервис распознавания блюд  
  - сервисы для блюд, продуктов, шаблонов и профиля

- `supabase/migrations` — миграции базы данных Supabase (схема, RLS и bucket для фото).

## Запуск

```bash
flutter pub get
flutter run
```

### С Supabase и OpenRouter (ключи через dart-define)

```bash
flutter run \
  --dart-define=SUPABASE_URL=https://ВАШ_ПРОЕКТ.supabase.co \
  --dart-define=SUPABASE_ANON_KEY=ВАШ_ANON_KEY \
  --dart-define=OPENROUTER_API_KEY=sk-or-v1-...
```

Все три ключа можно передать одной строкой. Без ключей приложение запустится с заглушками (без БД и без реального ИИ).

## База данных Supabase

Схема и RLS лежат в `supabase/migrations/`:

1. `20250208000001_initial_schema.sql` — таблицы `profiles`, `products`, `dishes`, `dish_products`, `dish_templates`, `dish_template_products`, триггеры и RLS.
2. `20250208000002_storage_bucket.sql` — bucket `dish-images` и политики доступа.

В Dashboard Supabase: выполнить миграции или скопировать SQL, создать проект и подставить URL и anon key в команду запуска.

## ИИ (OpenRouter)

При заданном `OPENROUTER_API_KEY` используется OpenRouter (модель `openai/gpt-4o-mini`) для анализа фото и текста: определение названия блюда и списка продуктов. Без ключа работает заглушка с фиксированным ответом. Сервис: `lib/services/openrouter_service.dart`.
