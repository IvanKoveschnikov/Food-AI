# Food AI ‚Äî –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞

## –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

**Food AI** ‚Äî –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Flutter –¥–ª—è —É—á—ë—Ç–∞ –ø–∏—Ç–∞–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ò–ò. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä–æ–≤–∞—Ç—å –±–ª—é–¥–∞, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –∏—Ö —Å–æ—Å—Ç–∞–≤ —Å –ø–æ–º–æ—â—å—é –ò–ò (OpenRouter API), –≤–µ—Å—Ç–∏ –¥–Ω–µ–≤–Ω–∏–∫ –ø–∏—Ç–∞–Ω–∏—è –ø–æ –¥–Ω—è–º –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –ª–∏—á–Ω—ã–º–∏ –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ –∏ —à–∞–±–ª–æ–Ω–∞–º–∏ –±–ª—é–¥.

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –±–ª—é–¥ –ø–æ —Ñ–æ—Ç–æ** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ò–ò, –ø–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∏ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- **–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è** ‚Äî –≤–≤–æ–¥ –±–ª—é–¥–∞ –≤—Ä—É—á–Ω—É—é —Å –ò–ò-–∞–Ω–∞–ª–∏–∑–æ–º —Å–æ—Å—Ç–∞–≤–∞
- **–ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø–∏—Ç–∞–Ω–∏—è** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–ª—é–¥ –ø–æ –¥–∞—Ç–∞–º
- **–ë–∞–∑–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤** ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–µ (–æ–±—â–∏–µ) –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–æ–¥—É–∫—Ç—ã
- **–®–∞–±–ª–æ–Ω—ã –±–ª—é–¥** ‚Äî –±—ã—Å—Ç—Ä–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏
- **Supabase Storage** ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ—Ç–æ –±–ª—é–¥ –≤ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º bucket

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è |
|-----------|------------|
| –§—Ä–µ–π–º–≤–æ—Ä–∫ | Flutter 3.38 |
| –Ø–∑—ã–∫ | Dart 3.10 |
| State Management | flutter_riverpod |
| –†–æ—É—Ç–∏–Ω–≥ | go_router |
| –ë—ç–∫–µ–Ω–¥ | Supabase (PostgreSQL, Auth, Storage) |
| –ò–ò | OpenRouter API (GPT-4o-mini) |
| –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è | flutter_localizations (ru, en) |
| –ö–∞–ª–µ–Ω–¥–∞—Ä—å | table_calendar |
| –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | image_picker |

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
lib/
‚îú‚îÄ‚îÄ main.dart                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Riverpod –∏ Supabase
‚îú‚îÄ‚îÄ core/                        # –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ config/                  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (env, Supabase)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ env.dart             # –ß—Ç–µ–Ω–∏–µ –∫–ª—é—á–µ–π –∏–∑ dart-define
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ supabase_config.dart
‚îÇ   ‚îú‚îÄ‚îÄ router/                  # –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app_router.dart      # GoRouter —Å —Ç–∞–±–∞–º–∏ –∏ —ç–∫—Ä–∞–Ω–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ theme/                   # –¢–µ–º—ã (Material 3)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app_theme.dart
‚îÇ   ‚îú‚îÄ‚îÄ constants/               # –°—Ç—Ä–æ–∫–æ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app_strings.dart
‚îÇ   ‚îî‚îÄ‚îÄ auth/                    # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ       ‚îî‚îÄ‚îÄ auth_notifier.dart   # Riverpod-–ø—Ä–æ–≤–∞–π–¥–µ—Ä auth-—Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îú‚îÄ‚îÄ features/                    # –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ auth/                    # –õ–æ–≥–∏–Ω/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login_screen.dart
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ register_screen.dart
‚îÇ   ‚îú‚îÄ‚îÄ home/                    # –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω —Å –∫–∞–ª–µ–Ω–¥–∞—Ä—ë–º
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ home_screen.dart
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ home_providers.dart
‚îÇ   ‚îú‚îÄ‚îÄ camera/                  # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–ª—é–¥ –ø–æ —Ñ–æ—Ç–æ/–æ–ø–∏—Å–∞–Ω–∏—é
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ camera_screen.dart
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ add_dish_no_photo_screen.dart
‚îÇ   ‚îú‚îÄ‚îÄ dish_detail/             # –î–µ—Ç–∞–ª–∏ –±–ª—é–¥–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dish_detail_screen.dart
‚îÇ   ‚îî‚îÄ‚îÄ profile/                 # –ü—Ä–æ—Ñ–∏–ª—å –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ       ‚îú‚îÄ‚îÄ profile_screen.dart
‚îÇ       ‚îú‚îÄ‚îÄ profile_products_screen.dart
‚îÇ       ‚îú‚îÄ‚îÄ global_products_screen.dart
‚îÇ       ‚îú‚îÄ‚îÄ templates_screen.dart
‚îÇ       ‚îî‚îÄ‚îÄ template_edit_screen.dart
‚îî‚îÄ‚îÄ services/                    # –°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π
    ‚îú‚îÄ‚îÄ supabase_service.dart    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Supabase
    ‚îú‚îÄ‚îÄ auth_service.dart        # –õ–æ–≥–∏–Ω/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è/–≤—ã—Ö–æ–¥
    ‚îú‚îÄ‚îÄ dishes_service.dart      # CRUD –±–ª—é–¥
    ‚îú‚îÄ‚îÄ products_service.dart    # CRUD –ø—Ä–æ–¥—É–∫—Ç–æ–≤
    ‚îú‚îÄ‚îÄ dish_products_service.dart  # –°–≤—è–∑–∏ –±–ª—é–¥–æ-–ø—Ä–æ–¥—É–∫—Ç—ã
    ‚îú‚îÄ‚îÄ dish_templates_service.dart  # –®–∞–±–ª–æ–Ω—ã –±–ª—é–¥
    ‚îú‚îÄ‚îÄ profile_service.dart     # –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    ‚îú‚îÄ‚îÄ storage_service.dart     # –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ –≤ Storage
    ‚îú‚îÄ‚îÄ openrouter_service.dart  # API –∫ OpenRouter
    ‚îî‚îÄ‚îÄ ai_service.dart          # –û–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ –ò–ò-—Å–µ—Ä–≤–∏—Å–æ–º
```

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (Supabase)

### –¢–∞–±–ª–∏—Ü—ã

| –¢–∞–±–ª–∏—Ü–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `profiles` | –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (id, display_name, avatar_url) |
| `products` | –ü—Ä–æ–¥—É–∫—Ç—ã (scope: global/user, name, created_by) |
| `dishes` | –ë–ª—é–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (user_id, name, date, image_url, description) |
| `dish_products` | –°–≤—è–∑—å –±–ª—é–¥–æ-–ø—Ä–æ–¥—É–∫—Ç—ã (dish_id, product_id, is_user_added) |
| `dish_templates` | –®–∞–±–ª–æ–Ω—ã –±–ª—é–¥ (user_id, name) |
| `dish_template_products` | –°–≤—è–∑—å —à–∞–±–ª–æ–Ω-–ø—Ä–æ–¥—É–∫—Ç—ã |

### Storage

- **Bucket:** `dish-images`
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞:** `{user_id}/{dish_id}.jpg`
- **–î–æ—Å—Ç—É–ø:** –ü—Ä–∏–≤–∞—Ç–Ω—ã–π, –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ URL

### –ú–∏–≥—Ä–∞—Ü–∏–∏

–§–∞–π–ª—ã –≤ `supabase/migrations/`:
1. `20250208000001_initial_schema.sql` ‚Äî —Å—Ö–µ–º–∞, RLS-–ø–æ–ª–∏—Ç–∏–∫–∏, —Ç—Ä–∏–≥–≥–µ—Ä—ã
2. `20250208000002_storage_bucket.sql` ‚Äî bucket –∏ –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞
3. `20250208000003_seed_global_products.sql` ‚Äî –Ω–∞—á–∞–ª—å–Ω—ã–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã

## –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫

```bash
flutter pub get
flutter run
```

### –ó–∞–ø—É—Å–∫ —Å –∫–ª—é—á–∞–º–∏ (Supabase + OpenRouter)

```bash
flutter run \
  --dart-define=SUPABASE_URL=https://–í–ê–®_–ü–†–û–ï–ö–¢.supabase.co \
  --dart-define=SUPABASE_ANON_KEY=–í–ê–®_ANON_KEY \
  --dart-define=OPENROUTER_API_KEY=sk-or-v1-...
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `lib/core/config/env.local.dart`:

```dart
const String localSupabaseUrl = 'https://...';
const String localSupabaseAnonKey = '...';
const String localOpenRouterApiKey = '...';
```

> –§–∞–π–ª `.env` –∏ `env.local.dart` –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è –≤ `.gitignore`.

## –≠–∫—Ä–∞–Ω—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

| –≠–∫—Ä–∞–Ω | –ú–∞—Ä—à—Ä—É—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|---------|----------|
| Splash | `/splash` | –ó–∞—Å—Ç–∞–≤–∫–∞ ~1.2—Å, —Ä–æ—É—Ç–∏–Ω–≥ –ø–æ auth-—Å—Ç–∞—Ç—É—Å—É |
| Login | `/login` | –í—Ö–æ–¥ –ø–æ email/–ø–∞—Ä–æ–ª—é |
| Register | `/register` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| Home | `/` | –ö–∞–ª–µ–Ω–¥–∞—Ä—å + —Å–ø–∏—Å–æ–∫ –±–ª—é–¥ –∑–∞ –¥–∞—Ç—É |
| Camera | `/camera` | –§–æ—Ç–æ –±–ª—é–¥–∞ ‚Üí –ò–ò-–∞–Ω–∞–ª–∏–∑ ‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ |
| Add No Photo | `/add-no-photo` | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–µ–∑ —Ñ–æ—Ç–æ (–æ–ø–∏—Å–∞–Ω–∏–µ/—à–∞–±–ª–æ–Ω) |
| Dish Detail | `/dish/:id` | –î–µ—Ç–∞–ª–∏ –±–ª—é–¥–∞, —Å–æ—Å—Ç–∞–≤, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |
| Profile | `/profile` | –ü—Ä–æ—Ñ–∏–ª—å, –ø—Ä–æ–¥—É–∫—Ç—ã, —à–∞–±–ª–æ–Ω—ã, –≤—ã—Ö–æ–¥ |

## –ù–∞–≤–∏–≥–∞—Ü–∏—è

–ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è (3 –≤–∫–ª–∞–¥–∫–∏):
1. **–ì–ª–∞–≤–Ω–∞—è** (`/`) ‚Äî –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –±–ª—é–¥–∞
2. **–§–æ—Ç–æ** (`/camera`) ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ —Ñ–æ—Ç–æ
3. **–ü—Ä–æ—Ñ–∏–ª—å** (`/profile`) ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞

```bash
flutter analyze
```

### –¢–µ—Å—Ç—ã

```bash
flutter test
```

### –õ–∏–Ω—Ç–µ—Ä—ã

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `package:flutter_lints/flutter.yaml` (—Å–º. `analysis_options.yaml`).

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

- **Riverpod** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º (–ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –¥–ª—è auth, –±–ª—é–¥, –ø—Ä–æ–¥—É–∫—Ç–æ–≤)
- **–°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π** ‚Äî –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å Supabase –∏ –≤–Ω–µ—à–Ω–∏–º–∏ API
- **Feature-first** ‚Äî –º–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ —Ñ–∏—á–∞–º (`features/*`)
- **GoRouter** ‚Äî –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ —Ä–æ—É—Ç–∞–º–∏

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **RLS-–ø–æ–ª–∏—Ç–∏–∫–∏** ‚Äî –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –ø–æ `user_id`
- **Auth** ‚Äî Supabase Auth —Å email/–ø–∞—Ä–æ–ª–µ–º
- **Storage** ‚Äî –ø—Ä–∏–≤–∞—Ç–Ω—ã–π bucket —Å –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–º–∏ URL
- **–ö–ª—é—á–∏** ‚Äî –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `--dart-define`, –Ω–µ –∫–æ–º–º–∏—Ç—è—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (MVP)

‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–ª—é–¥ –ø–æ —Ñ–æ—Ç–æ —Å –ò–ò-–∞–Ω–∞–ª–∏–∑–æ–º
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–ª—é–¥ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é/—à–∞–±–ª–æ–Ω—É
- –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å –æ—Ç–º–µ—Ç–∫–∞–º–∏ –¥–Ω–µ–π
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ –∏ —à–∞–±–ª–æ–Ω–∞–º–∏
- RLS-–ø–æ–ª–∏—Ç–∏–∫–∏ –∏ Storage

üîÑ –í –ø–ª–∞–Ω–∞—Ö:
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –±–ª—é–¥ –ø–æ –ø—Ä–∏—ë–º–∞–º –ø–∏—â–∏
- –ù—É—Ç—Ä–∏—Ü–∏–æ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–∫–∞–ª–æ—Ä–∏–∏, –ë–ñ–£)
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
